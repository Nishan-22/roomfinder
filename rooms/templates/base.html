<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}RoomFinder | Premium Living{% endblock %}</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: { extend: { colors: { brand: { 600: '#2563eb' }}}}
        }
    </script>

    <style>
        @keyframes fadeIn { from { opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
        .animate-fade-in { animation: fadeIn .6s ease-out forwards; }
        .glass { background:rgba(255,255,255,.7); backdrop-filter:blur(12px); }
        .dark .glass { background:rgba(15,23,42,.7); }
    </style>
</head>

<body class="bg-[#f8fafc] dark:bg-gray-950 text-gray-900 dark:text-gray-100 min-h-screen">

<header id="navbar" class="sticky top-0 z-50 border-b border-gray-200 dark:border-gray-800">
    <nav class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

        <!-- Logo -->
        <a href="{% url 'room_list' %}" class="text-2xl font-black text-blue-600">RoomFinder</a>

        <!-- Nav Links -->
        <div class="hidden md:flex items-center space-x-6 font-bold text-sm uppercase">
    <a href="{% url 'room_list' %}" class="hover:text-blue-600">Explore</a>

    {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}" class="hover:text-blue-600">Dashboard</a>
    {% endif %}
</div>

        <!-- Right Side -->
        <div class="flex items-center space-x-4">

            <!-- üåô THEME TOGGLE -->
            <button id="theme-toggle"
                class="p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                <span id="theme-toggle-dark-icon" class="hidden">üåô</span>
                <span id="theme-toggle-light-icon" class="hidden">‚òÄÔ∏è</span>
            </button>

            {% if user.is_authenticated %}
                <span class="text-sm font-bold">{{ user.username }}</span>

                <!-- Logout Button -->
                <button id="logoutBtn"
                    class="text-xs font-black uppercase text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 px-3 py-2 rounded-lg transition">
                    Logout
                </button>
            {% else %}
                <a href="{% url 'login' %}" class="font-bold">Login</a>
            {% endif %}
        </div>
    </nav>

    <!-- Hidden Logout Form -->
    <form id="logoutForm" action="{% url 'logout' %}" method="POST" class="hidden">
        {% csrf_token %}
    </form>
</header>

<main class="min-h-[80vh]">
    {% if messages %}
    <div class="max-w-4xl mx-auto px-4 py-2">
        {% for message in messages %}
        <div class="mb-2 p-4 rounded-xl {% if message.tags == 'error' %}bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 border border-red-200 dark:border-red-800{% else %}bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 border border-blue-200{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% block content %}{% endblock %}
</main>

<!-- LOGOUT MODAL -->
<div id="logoutModal" class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden items-center justify-center z-[200]">
    <div class="glass w-[90%] max-w-md p-8 rounded-3xl shadow-2xl text-center animate-fade-in">
        <h2 class="text-2xl font-black mb-4">Are you sure you want to logout?</h2>
        <p class="text-sm text-gray-500 dark:text-gray-400 mb-8">You‚Äôll need to login again.</p>

        <div class="flex gap-4">
            <button id="cancelLogout"
                class="w-1/2 py-3 rounded-2xl bg-gray-200 dark:bg-gray-700 font-bold hover:bg-gray-300 dark:hover:bg-gray-600 transition">
                Cancel
            </button>
            <button id="confirmLogout"
                class="w-1/2 py-3 rounded-2xl bg-red-600 text-white font-bold hover:bg-red-700 transition">
                Yes, Logout
            </button>
        </div>
    </div>
</div>

<!-- SCRIPTS -->
<script>
    // üåô THEME SYSTEM
    const themeToggleBtn = document.getElementById('theme-toggle');
    const darkIcon = document.getElementById('theme-toggle-dark-icon');
    const lightIcon = document.getElementById('theme-toggle-light-icon');

    function syncIcons() {
        if (document.documentElement.classList.contains('dark')) {
            lightIcon.classList.remove('hidden');
            darkIcon.classList.add('hidden');
        } else {
            darkIcon.classList.remove('hidden');
            lightIcon.classList.add('hidden');
        }
    }

    if (localStorage.getItem('color-theme') === 'dark' ||
        (!localStorage.getItem('color-theme') &&
         window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    } else {
        document.documentElement.classList.remove('dark');
    }
    syncIcons();

    themeToggleBtn?.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        localStorage.setItem('color-theme',
            document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        syncIcons();
    });

    // üö™ LOGOUT MODAL
    const logoutBtn = document.getElementById("logoutBtn");
    const logoutModal = document.getElementById("logoutModal");
    const cancelLogout = document.getElementById("cancelLogout");
    const confirmLogout = document.getElementById("confirmLogout");
    const logoutForm = document.getElementById("logoutForm");

    logoutBtn?.addEventListener("click", () => {
        logoutModal.classList.remove("hidden");
        logoutModal.classList.add("flex");
    });

    cancelLogout?.addEventListener("click", () => {
        logoutModal.classList.add("hidden");
    });

    confirmLogout?.addEventListener("click", () => {
        logoutForm.submit();
    });
</script>

</body>
</html>